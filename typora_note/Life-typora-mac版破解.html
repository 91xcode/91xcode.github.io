<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Life-typora-mac版破解</title>
</head>
<body><p>@<a href='这里写自定义目录标题'>TOC</a></p>
<h1 id='typora-mac版破解'>Typora mac版破解</h1>
<h2 id='前言'>前言</h2>
<p>请勿使用盗版，支持正版授权。
文中内容仅作学习和讨论，请不要从事任何非法行为。
由此产生的任何问题都将读者/用户（您）承担。</p>
<p> </p>
<p>先说结论：破解点很简单，只改了js代码的一个判断条件（不看分析可以直接看第四点），这里分享我的分析流程。
本帖使用目前最新版typora：1.3.7 (6424)</p>
<h2 id='一寻踪觅源'>一、寻踪觅源</h2>
<p>一开始想尝试查看typora的运行日志，看看日志有无license的验证过程，然而发现我找不到；
运行typora，打开活动监视器，查看typora操作了哪些文件
<img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020408785.png" referrerpolicy="no-referrer" alt="image-20231210020408785"> </p>
<p>疑似的两个日志文件：
<img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020449504.png" referrerpolicy="no-referrer" alt="image-20231210020449504"> </p>
<p><img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020522911.png" referrerpolicy="no-referrer" alt="image-20231210020522911"></p>
<p>实际分析发现不是我们想要的。
进一步在系统目录尝试了寻找有无typora相关的文件：
<code>find /Library -name Typora</code>
仍然没有，既然找不到记录日志，就换个思路。</p>
<h2 id='二渐入佳境'>二、渐入佳境</h2>
<p>之前分析过windows的terminus、typora，猜测很有可能license在js代码里验证，所以直接在Typora.app 全局搜索license字段试试：
显示包内容 -&gt; 目录Contents/Resources/TypeMark -&gt; 拖进vscode搜索：
（稍微熟悉点app的包结构的话，应该知道js代码应该在资源目录下，然后分析一下会发现TypeMark是一个可疑地目录）
<img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020550344.png" referrerpolicy="no-referrer" alt="image-20231210020550344">
发现找到139个文件，也没法一个一个看，还得换个思路。</p>
<p> </p>
<p>进入typora，弹出购买窗口，点击购买，获取购买链接字符串:</p>
<p> <img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020627419.png" referrerpolicy="no-referrer" alt="image-20231210020627419"></p>
<p>&nbsp;</p>
<p><img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020645135.png" referrerpolicy="no-referrer" alt="image-20231210020645135"></p>
<p>&nbsp;</p>
<p><img src="/Users/liubing/Library/Application Support/typora-user-images/image-20231210020707340.png" referrerpolicy="no-referrer" alt="image-20231210020707340"> </p>
<p>尝试全局搜索购买链接的字符串<code>https://store.typora.io/</code>，发现还真有：
<img src="https://bbs.pediy.com/upload/attach/202206/726474_A8T75U5G52UVMTW.png" referrerpolicy="no-referrer" alt="图片描述">
一看文件名license，大概率是这个文件。</p>
<h2 id='三柳暗花明'>三、柳暗花明</h2>
<p>vscode打开该文件：
<img src="https://bbs.pediy.com/upload/attach/202206/726474_P74VCB8MZMEZ4TW.png" referrerpolicy="no-referrer" alt="图片描述">
需要先安装插件格式化js，这个不赘述了，格式化后如下：
<img src="https://bbs.pediy.com/upload/attach/202206/726474_VF9KUZQVG4G6Z58.png" referrerpolicy="no-referrer" alt="图片描述">
接下来分析下js代码（我大多数时候看直觉）：
链接字符串上下文代码大致是用来创建html元素，好像没什么用，只是知道购买弹窗确实是这一部分代码：
<img src="https://bbs.pediy.com/upload/attach/202206/726474_WR5GDXYCPX72G44.png" referrerpolicy="no-referrer" alt="图片描述"></p>
<p> </p>
<p>再往下看几行代码发现可疑地一些函数：
<code>useState</code> 函数可能是用户的使用状态；
<code>hasActivated</code> 变量可能是是否被激活；
<img src="https://bbs.pediy.com/upload/attach/202206/726474_55H9FXDWFF3AZ56.png" referrerpolicy="no-referrer" alt="图片描述">
那么就去看一下 <code>hasActivated</code>的定义，发现如下：
<img src="https://bbs.pediy.com/upload/attach/202206/726474_QVRA3KCGQYSD57V.png" referrerpolicy="no-referrer" alt="图片描述"></p>
<p> </p>
<p><code>=</code> 赋值语句
<code>==</code> 判断语句，判断值是否相等
尝试修改：<code>e.hasActivated = &quot;true&quot; == &quot;true&quot;</code>
成功。
<img src="https://bbs.pediy.com/upload/attach/202206/726474_K54WDU5KRSH3CRB.png" referrerpolicy="no-referrer" alt="图片描述"></p>
<h2 id='四落叶归根'>四、落叶归根</h2>
<p>只需要将文件
<code>Typora.app/Contents/Resources/TypeMark/page-dist/static/js/LicenseIndex.180dd4c7.5dc16d09.chunk.js</code>
这一行代码
<code>e.hasActivated = &quot;true&quot; == e.hasActivated</code>
<img src="https://bbs.pediy.com/upload/attach/202206/726474_CG7WXR25HYWCN99.png" referrerpolicy="no-referrer" alt="图片描述">
改为
<code>e.hasActivated = &quot;true&quot; == &quot;true&quot;</code>
保存即可。</p>
<h2 id='尾声'>尾声</h2>
<p>字符串加密还是很有用的。</p>
<p>&nbsp;</p>
<p>来源：<a href='https://bbs.pediy.com/thread-273420.htm' target='_blank' class='url'>https://bbs.pediy.com/thread-273420.htm</a></p>
</body>
</html>